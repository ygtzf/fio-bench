FIO使用说明
==========

## 说明
FIO是进行IO测试的标准工具，可以针对读写模式，块大小，队列深度，测试时长等进行灵
活测试。测试结束后，fio会给出详细的聚合带宽/IOPS/延迟等指标。

## 安装
install-fio.sh是来安装fio的脚本，通过下载源码编译的，只要安装了rbd库，就会编译出
支持rbd引擎的fio。在同一平台上测试，可以只编译一次，该平台上的其他机器都使用该二
进制程序。当然，不能忘了libaio-devel和librbd-devel这两个包。

## 使用
run.sh是将存储平台关注的一整套的测试整合到一起，包括随机写、随机读、顺序写、顺序读
、随机混合读写。方便对新集群做基准测试。最后结果都输出在对应文件中。

该脚本适合完整的性能测试，不适合单个测试，如果是单独测试某一项的话，需要修改脚本
，注释掉多余的测试。

在每次测试的时候,需要如下操作：
1. FIO_FILE
   该参数是测试对象，可以是磁盘、文件、rbd image。
   例: /dev/sdc、test(filename)、bench-image(image name)
2. FIO_RUNTIME
   该参数是设置测试时长，单位是s，默认600s
3. FIO_IODEPTH
   该参数是设置IO队列深度，一般为了测试存储平台最大性能，会设置为`32`或`64`
4. FIO_JOBS
   同时进行fio测试的job数，默认是1，**这个可能有点问题**

使用示例：
   ./run.sh rbd   ---- 测试rbd image

   ./run.sh disk  ---- 测试某个磁盘

   ./run.sh file  ---- 测试经过格式化过的文件系统

另外, 关于fio的几个参数：
* 随机读写模式可以通过`rwmixread=`控制读写比例。
* blocksize

一般应用模式为数据库等场景下，可以采取`4k`,`8k`等小数据块，关注IOPS性能。
应用模式为视频存储，归档等场景下，可以采用`1m`,`4m`等大数据块，关注带宽吞吐性能。
